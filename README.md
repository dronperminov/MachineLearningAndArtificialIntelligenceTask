# MachineLearningAndArtificialIntelligenceTask
Реализация практического задания в рамках математического спецкурса "Машинное обучение и искусственный интеллект" на ВМК МГУ в 2022

## Решаемая задача и набор данных
В рамках работы над одним проектом, необходимо классифицировать строки документов с техническим заданием на следующие классы:

* `raw_text` - обычный текст
* `title` - название документа
* `toc` - элемент содержания
* `item` - заголовок
* `part` - пункт списка

Каждая строка определяется следующими параметрами:

* `day_month_regexp` - срабатывание регулярного выражения дня и месяца
* `year_regexp` - срабатывание регулярного выражения года
* `dot_number_regexp` - срабатывание регулярного выражения на маркированный список
* `named_item_regexp` - срабатывание регулярного выражения на нумерованный список
* `dot_number_regexp_len` - длина вхождения подстроки в маркированный список
* `indentation` - отступ
* `is_in_toc` - входит ли в содержание
* `is_lower` - вся ли строка в нижнем регистре
* `is_toc_line` - предсталвяет ли строку содержания
* `is_upper` - вся ли строка в верхнем регистре
* `line_id` - номер строки
* `list_item` - элемент списка
* `start_regexp_0` - срабатывание первого начального регулярного выражения
* `start_regexp_1` - срабатывание второго начального регулярного выражения
* `start_regexp_2` - срабатывание третьего начального регулярного выражения
* `start_regexp_3` - срабатывание четвёртого начального регулярного выражения
* `start_regexp_num_matches` - количество срабатываний начальных регулярных выражений
* `text_length` - длина текста
* `words_number` - количество слов
* `uid` - уникальный идентификатор
* `text` - текстовое содержимое
* `label` - целевая метка

Для классификации помимо текущей строки используются некоторые параметры трёх строк выше и трёх строк ниже классифицируемой. Такие признаки оканчиваются на `_prev_{1..3}` и `_next_{1..3}`, например, `is_lower_prev_3`.

### Параметры набора данных

* Количество признаков: 145
* Количество элементов: 8557

## Результаты кроссвалидации
### KNN
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.5907 |     0.4079 |     0.5604 |     0.5361 |     0.3747 |     0.4846 |     0.5238 |     0.4610 |     0.5233 |     0.5613 |     0.5024 |
| Precision  |    0.3652 |     0.3720 |     0.4780 |     0.4807 |     0.3395 |     0.4923 |     0.5014 |     0.4358 |     0.5316 |     0.5487 |     0.4545 |
| f1         |    0.4118 |     0.3852 |     0.4931 |     0.4940 |     0.3442 |     0.4880 |     0.4878 |     0.4097 |     0.4812 |     0.5377 |     0.4533 |
| Accuracy   |    0.5596 |     0.5724 |     0.4650 |     0.5082 |     0.7407 |     0.9311 |     0.4947 |     0.4807 |     0.4901 |     0.5591 |     0.5801 |

### Naive Bayes
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.7818 |     0.5838 |     0.6286 |     0.6781 |     0.3830 |     0.2296 |     0.6465 |     0.5510 |     0.6772 |     0.5349 |     0.5695 |
| Precision  |    0.7686 |     0.4877 |     0.7708 |     0.7439 |     0.4022 |     0.1581 |     0.6810 |     0.6088 |     0.7222 |     0.6333 |     0.5977 |
| f1         |    0.7692 |     0.4987 |     0.5974 |     0.6543 |     0.3478 |     0.0991 |     0.5810 |     0.5132 |     0.6619 |     0.5304 |     0.5253 |
| Accuracy   |    0.8026 |     0.6600 |     0.6297 |     0.6834 |     0.5970 |     0.1542 |     0.6211 |     0.5485 |     0.6468 |     0.5509 |     0.5894 |

### SVM
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.2718 |     0.4593 |     0.2158 |     0.5123 |     0.7829 |     0.2418 |     0.4918 |     0.5742 |     0.4420 |     0.6520 |     0.4644 |
| Precision  |    0.2505 |     0.3438 |     0.1595 |     0.3137 |     0.5611 |     0.2491 |     0.2477 |     0.3474 |     0.2246 |     0.3205 |     0.3018 |
| f1         |    0.1929 |     0.3685 |     0.1556 |     0.3180 |     0.5654 |     0.2454 |     0.2325 |     0.3416 |     0.2029 |     0.3305 |     0.2953 |
| Accuracy   |    0.4428 |     0.6098 |     0.3107 |     0.4077 |     0.7465 |     0.9638 |     0.3778 |     0.4398 |     0.3029 |     0.4105 |     0.5012 |

### Ridge
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.8843 |     0.8494 |     0.8429 |     0.8500 |     0.9152 |     0.8520 |     0.8733 |     0.8378 |     0.8316 |     0.8498 |     0.8586 |
| Precision  |    0.6342 |     0.6987 |     0.9263 |     0.8017 |     0.6988 |     0.7500 |     0.7550 |     0.6750 |     0.7789 |     0.7731 |     0.7492 |
| f1         |    0.7096 |     0.7541 |     0.8725 |     0.8162 |     0.7318 |     0.7409 |     0.7795 |     0.7213 |     0.7989 |     0.8010 |     0.7726 |
| Accuracy   |    0.8259 |     0.8493 |     0.9042 |     0.8902 |     0.8902 |     0.9778 |     0.8374 |     0.8444 |     0.8468 |     0.8480 |     0.8714 |

### MLP
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.8655 |     0.7608 |     0.8695 |     0.8142 |     0.7690 |     0.6994 |     0.8812 |     0.7854 |     0.7884 |     0.7777 |     0.8011 |
| Precision  |    0.6785 |     0.8582 |     0.8271 |     0.8309 |     0.7418 |     0.6953 |     0.8481 |     0.7304 |     0.8669 |     0.7708 |     0.7848 |
| f1         |    0.7385 |     0.7754 |     0.8252 |     0.8191 |     0.7537 |     0.6960 |     0.8593 |     0.7442 |     0.8113 |     0.7591 |     0.7782 |
| Accuracy   |    0.8329 |     0.8528 |     0.8563 |     0.8820 |     0.8493 |     0.9942 |     0.8795 |     0.8281 |     0.8842 |     0.7825 |     0.8642 |

### Decision tree
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.8057 |     0.4701 |     0.7559 |     0.7747 |     0.4614 |     0.4834 |     0.8321 |     0.7394 |     0.7724 |     0.7592 |     0.6854 |
| Precision  |    0.7438 |     0.6307 |     0.8575 |     0.8703 |     0.4381 |     0.5103 |     0.7972 |     0.6595 |     0.8520 |     0.7705 |     0.7130 |
| f1         |    0.7505 |     0.4830 |     0.7992 |     0.8132 |     0.4474 |     0.4920 |     0.8095 |     0.6842 |     0.8009 |     0.7633 |     0.6843 |
| Accuracy   |    0.8037 |     0.6811 |     0.8703 |     0.8692 |     0.8843 |     0.9778 |     0.8491 |     0.7778 |     0.8491 |     0.8000 |     0.8362 |

### Random forest
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.8454 |     0.8585 |     0.9595 |     0.9472 |     0.6935 |     0.9992 |     0.9081 |     0.9225 |     0.8507 |     0.8451 |     0.8830 |
| Precision  |    0.5745 |     0.8884 |     0.9500 |     0.8840 |     0.5764 |     0.9454 |     0.8371 |     0.7261 |     0.8948 |     0.7898 |     0.8067 |
| f1         |    0.6191 |     0.8664 |     0.9544 |     0.9094 |     0.6093 |     0.9710 |     0.8646 |     0.7792 |     0.8639 |     0.8123 |     0.8250 |
| Accuracy   |    0.8002 |     0.8820 |     0.9650 |     0.9322 |     0.9100 |     0.9977 |     0.8959 |     0.8830 |     0.8982 |     0.8538 |     0.9018 |

### Gradient boost
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.8966 |     0.5546 |     0.9365 |     0.9078 |     0.7017 |     0.7494 |     0.9247 |     0.8797 |     0.8897 |     0.8885 |     0.8329 |
| Precision  |    0.8046 |     0.6795 |     0.9146 |     0.9085 |     0.5733 |     0.7079 |     0.8488 |     0.7453 |     0.9142 |     0.8243 |     0.7921 |
| f1         |    0.8378 |     0.5498 |     0.9227 |     0.9058 |     0.6071 |     0.7276 |     0.8787 |     0.7891 |     0.8981 |     0.8504 |     0.7967 |
| Accuracy   |    0.8680 |     0.8201 |     0.9544 |     0.9276 |     0.9112 |     0.9930 |     0.9099 |     0.8655 |     0.9170 |     0.8842 |     0.9051 |

### XGBoost
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.8860 |     0.5871 |     0.8953 |     0.9227 |     0.6929 |     0.9622 |     0.9202 |     0.9033 |     0.8866 |     0.8535 |     0.8510 |
| Precision  |    0.7796 |     0.7159 |     0.9084 |     0.9425 |     0.5772 |     0.9450 |     0.8560 |     0.7561 |     0.9182 |     0.8428 |     0.8242 |
| f1         |    0.8233 |     0.6010 |     0.9003 |     0.9313 |     0.6096 |     0.9534 |     0.8800 |     0.8033 |     0.8990 |     0.8469 |     0.8248 |
| Accuracy   |    0.8692 |     0.8657 |     0.9439 |     0.9276 |     0.9112 |     0.9965 |     0.9123 |     0.8678 |     0.9427 |     0.8819 |     0.9119 |

### CatBoost
| Разбиение  |    1 / 10 |     2 / 10 |     3 / 10 |     4 / 10 |     5 / 10 |     6 / 10 |     7 / 10 |     8 / 10 |     9 / 10 |    10 / 10 |  в среднем |
|       :-:  |       :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |        :-: |
| Recall     |    0.9225 |     0.7452 |     0.9247 |     0.9302 |     0.9496 |     0.9622 |     0.9249 |     0.9245 |     0.8747 |     0.8457 |     0.9004 |
| Precision  |    0.7939 |     0.8815 |     0.9147 |     0.9369 |     0.7661 |     0.9450 |     0.8560 |     0.7866 |     0.9354 |     0.8141 |     0.8630 |
| f1         |    0.8456 |     0.7778 |     0.9182 |     0.9327 |     0.8127 |     0.9534 |     0.8814 |     0.8329 |     0.8970 |     0.8282 |     0.8680 |
| Accuracy   |    0.8855 |     0.8633 |     0.9498 |     0.9334 |     0.9136 |     0.9965 |     0.9088 |     0.8901 |     0.9298 |     0.8678 |     0.9139 |

### Усреднённые результаты кроссвалидации
|           Модель           | Recall | Precision | macro f1 | Accuracy |
|                        :-: |    :-: |       :-: |      :-: |      :-: |
| KNN                        | 0.5024 |    0.4545 |   0.4533 |   0.5801 |
| Naive Bayes                | 0.5695 |    0.5977 |   0.5253 |   0.5894 |
| SVM                        | 0.4644 |    0.3018 |   0.2953 |   0.5012 |
| Ridge                      | 0.8586 |    0.7492 |   0.7726 |   0.8714 |
| MLP                        | 0.8011 |    0.7848 |   0.7782 |   0.8642 |
| Decision tree              | 0.6854 |     0.713 |   0.6843 |   0.8362 |
| Random forest              |  0.883 |    0.8067 |    0.825 |   0.9018 |
| Gradient boost             | 0.8329 |    0.7921 |   0.7967 |   0.9051 |
| XGBoost                    |  0.851 |    0.8242 |   0.8248 |   0.9119 |
| **CatBoost**                   | **0.9004** |     **0.863** |    **0.868** |   **0.9139** |
