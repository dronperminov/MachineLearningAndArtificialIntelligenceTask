# MachineLearningAndArtificialIntelligenceTask
Реализация практического задания в рамках математического спецкурса "Машинное обучение и искусственный интеллект" на ВМК МГУ в 2022

## Решаемая задача и набор данных
В рамках работы над одним проектом, необходимо классифицировать строки документов с техническим заданием на следующие классы:

* `raw_text` - обычный текст
* `title` - название документа
* `toc` - элемент содержания
* `item` - заголовок
* `part` - пункт списка

Каждая строка определяется следующими параметрами:

* `day_month_regexp` - срабатывание регулярного выражения дня и месяца
* `year_regexp` - срабатывание регулярного выражения года
* `dot_number_regexp` - срабатывание регулярного выражения на маркированный список
* `named_item_regexp` - срабатывание регулярного выражения на нумерованный список
* `dot_number_regexp_len` - длина вхождения подстроки в маркированный список
* `indentation` - отступ
* `is_in_toc` - входит ли в содержание
* `is_lower` - вся ли строка в нижнем регистре
* `is_toc_line` - предсталвяет ли строку содержания
* `is_upper` - вся ли строка в верхнем регистре
* `line_id` - номер строки
* `list_item` - элемент списка
* `start_regexp_0` - срабатывание первого начального регулярного выражения
* `start_regexp_1` - срабатывание второго начального регулярного выражения
* `start_regexp_2` - срабатывание третьего начального регулярного выражения
* `start_regexp_3` - срабатывание четвёртого начального регулярного выражения
* `start_regexp_num_matches` - количество срабатываний начальных регулярных выражений
* `text_length` - длина текста
* `words_number` - количество слов
* `uid` - уникальный идентификатор
* `text` - текстовое содержимое
* `label` - целевая метка

Для классификации помимо текущей строки используются некоторые параметры трёх строк выше и трёх строк ниже классифицируемой. Такие признаки оканчиваются на `_prev_{1..3}` и `_next_{1..3}`, например, `is_lower_prev_3`.

### Параметры набора данных

* Количество признаков: 145
* Количество элементов: 8557

## Результаты кроссвалидации:
### KNN
| Разбиение | Recall | Precision | macro f1 | Accuracy |
|       :-: |    :-: |       :-: |      :-: |      :-: |
| 1 / 10    | 0.5907 |    0.3652 |   0.4118 |   0.5596 |
| 2 / 10    | 0.4079 |     0.372 |   0.3852 |   0.5724 |
| 3 / 10    | 0.5604 |     0.478 |   0.4931 |    0.465 |
| 4 / 10    | 0.5361 |    0.4807 |    0.494 |   0.5082 |
| 5 / 10    | 0.3747 |    0.3395 |   0.3442 |   0.7407 |
| 6 / 10    | 0.4846 |    0.4923 |    0.488 |   0.9311 |
| 7 / 10    | 0.5238 |    0.5014 |   0.4878 |   0.4947 |
| 8 / 10    |  0.461 |    0.4358 |   0.4097 |   0.4807 |
| 9 / 10    | 0.5233 |    0.5316 |   0.4812 |   0.4901 |
| 10 / 10   | 0.5613 |    0.5487 |   0.5377 |   0.5591 |

### Naive Bayes
| Разбиение | Recall | Precision | macro f1 | Accuracy |
|       :-: |    :-: |       :-: |      :-: |      :-: |
| 1 / 10    | 0.7818 |    0.7686 |   0.7692 |   0.8026 |
| 2 / 10    | 0.5838 |    0.4877 |   0.4987 |     0.66 |
| 3 / 10    | 0.6286 |    0.7708 |   0.5974 |   0.6297 |
| 4 / 10    | 0.6781 |    0.7439 |   0.6543 |   0.6834 |
| 5 / 10    |  0.383 |    0.4022 |   0.3478 |    0.597 |
| 6 / 10    | 0.2296 |    0.1581 |  0.09909 |   0.1542 |
| 7 / 10    | 0.6465 |     0.681 |    0.581 |   0.6211 |
| 8 / 10    |  0.551 |    0.6088 |   0.5132 |   0.5485 |
| 9 / 10    | 0.6772 |    0.7222 |   0.6619 |   0.6468 |
| 10 / 10   | 0.5349 |    0.6333 |   0.5304 |   0.5509 |

### SVM
| Разбиение | Recall | Precision | macro f1 | Accuracy |
|       :-: |    :-: |       :-: |      :-: |      :-: |
| 1 / 10    | 0.2718 |    0.2505 |   0.1929 |   0.4428 |
| 2 / 10    | 0.4593 |    0.3438 |   0.3685 |   0.6098 |
| 3 / 10    | 0.2158 |    0.1595 |   0.1556 |   0.3107 |
| 4 / 10    | 0.5123 |    0.3137 |    0.318 |   0.4077 |
| 5 / 10    | 0.7829 |    0.5611 |   0.5654 |   0.7465 |
| 6 / 10    | 0.2418 |    0.2491 |   0.2454 |   0.9638 |
| 7 / 10    | 0.4918 |    0.2477 |   0.2325 |   0.3778 |
| 8 / 10    | 0.5742 |    0.3474 |   0.3416 |   0.4398 |
| 9 / 10    |  0.442 |    0.2246 |   0.2029 |   0.3029 |
| 10 / 10   |  0.652 |    0.3205 |   0.3305 |   0.4105 |

### MLP
| Разбиение | Recall | Precision | macro f1 | Accuracy |
|       :-: |    :-: |       :-: |      :-: |      :-: |
| 1 / 10    | 0.8655 |    0.6785 |   0.7385 |   0.8329 |
| 2 / 10    | 0.7608 |    0.8582 |   0.7754 |   0.8528 |
| 3 / 10    | 0.8695 |    0.8271 |   0.8252 |   0.8563 |
| 4 / 10    | 0.8142 |    0.8309 |   0.8191 |    0.882 |
| 5 / 10    |  0.769 |    0.7418 |   0.7537 |   0.8493 |
| 6 / 10    | 0.6994 |    0.6953 |    0.696 |   0.9942 |
| 7 / 10    | 0.8812 |    0.8481 |   0.8593 |   0.8795 |
| 8 / 10    | 0.7854 |    0.7304 |   0.7442 |   0.8281 |
| 9 / 10    | 0.7884 |    0.8669 |   0.8113 |   0.8842 |
| 10 / 10   | 0.7777 |    0.7708 |   0.7591 |   0.7825 |

### Decision tree
| Разбиение | Recall | Precision | macro f1 | Accuracy |
|       :-: |    :-: |       :-: |      :-: |      :-: |
| 1 / 10    | 0.8057 |    0.7438 |   0.7505 |   0.8037 |
| 2 / 10    | 0.4701 |    0.6307 |    0.483 |   0.6811 |
| 3 / 10    | 0.7559 |    0.8575 |   0.7992 |   0.8703 |
| 4 / 10    | 0.7747 |    0.8703 |   0.8132 |   0.8692 |
| 5 / 10    | 0.4614 |    0.4381 |   0.4474 |   0.8843 |
| 6 / 10    | 0.4834 |    0.5103 |    0.492 |   0.9778 |
| 7 / 10    | 0.8321 |    0.7972 |   0.8095 |   0.8491 |
| 8 / 10    | 0.7394 |    0.6595 |   0.6842 |   0.7778 |
| 9 / 10    | 0.7724 |     0.852 |   0.8009 |   0.8491 |
| 10 / 10   | 0.7592 |    0.7705 |   0.7633 |      0.8 |

### Random forest
| Разбиение | Recall | Precision | macro f1 | Accuracy |
|       :-: |    :-: |       :-: |      :-: |      :-: |
| 1 / 10    | 0.8454 |    0.5745 |   0.6191 |   0.8002 |
| 2 / 10    | 0.8585 |    0.8884 |   0.8664 |    0.882 |
| 3 / 10    | 0.9595 |      0.95 |   0.9544 |    0.965 |
| 4 / 10    | 0.9472 |     0.884 |   0.9094 |   0.9322 |
| 5 / 10    | 0.6935 |    0.5764 |   0.6093 |     0.91 |
| 6 / 10    | 0.9992 |    0.9454 |    0.971 |   0.9977 |
| 7 / 10    | 0.9081 |    0.8371 |   0.8646 |   0.8959 |
| 8 / 10    | 0.9225 |    0.7261 |   0.7792 |    0.883 |
| 9 / 10    | 0.8507 |    0.8948 |   0.8639 |   0.8982 |
| 10 / 10   | 0.8451 |    0.7898 |   0.8123 |   0.8538 |

### XGBoost
| Разбиение | Recall | Precision | macro f1 | Accuracy |
|       :-: |    :-: |       :-: |      :-: |      :-: |
| 1 / 10    |  0.886 |    0.7796 |   0.8233 |   0.8692 |
| 2 / 10    | 0.5871 |    0.7159 |    0.601 |   0.8657 |
| 3 / 10    | 0.8953 |    0.9084 |   0.9003 |   0.9439 |
| 4 / 10    | 0.9227 |    0.9425 |   0.9313 |   0.9276 |
| 5 / 10    | 0.6929 |    0.5772 |   0.6096 |   0.9112 |
| 6 / 10    | 0.9622 |     0.945 |   0.9534 |   0.9965 |
| 7 / 10    | 0.9202 |     0.856 |     0.88 |   0.9123 |
| 8 / 10    | 0.9033 |    0.7561 |   0.8033 |   0.8678 |
| 9 / 10    | 0.8866 |    0.9182 |    0.899 |   0.9427 |
| 10 / 10   | 0.8535 |    0.8428 |   0.8469 |   0.8819 |

### CatBoost
| Разбиение | Recall | Precision | macro f1 | Accuracy |
|       :-: |    :-: |       :-: |      :-: |      :-: |
| 1 / 10    | 0.9225 |    0.7939 |   0.8456 |   0.8855 |
| 2 / 10    | 0.7452 |    0.8815 |   0.7778 |   0.8633 |
| 3 / 10    | 0.9247 |    0.9147 |   0.9182 |   0.9498 |
| 4 / 10    | 0.9302 |    0.9369 |   0.9327 |   0.9334 |
| 5 / 10    | 0.9496 |    0.7661 |   0.8127 |   0.9136 |
| 6 / 10    | 0.9622 |     0.945 |   0.9534 |   0.9965 |
| 7 / 10    | 0.9249 |     0.856 |   0.8814 |   0.9088 |
| 8 / 10    | 0.9245 |    0.7866 |   0.8329 |   0.8901 |
| 9 / 10    | 0.8747 |    0.9354 |    0.897 |   0.9298 |
| 10 / 10   | 0.8457 |    0.8141 |   0.8282 |   0.8678 |

### Усреднённые результаты кроссвалидации
|           Модель           | Recall | Precision | macro f1 | Accuracy |
|                        :-: |    :-: |       :-: |      :-: |      :-: |
| KNN                        | 0.5024 |    0.4545 |   0.4533 |   0.5801 |
| Naive Bayes                | 0.5695 |    0.5977 |   0.5253 |   0.5894 |
| SVM                        | 0.4644 |    0.3018 |   0.2953 |   0.5012 |
| MLP                        | 0.8011 |    0.7848 |   0.7782 |   0.8642 |
| Decision tree              | 0.6854 |     0.713 |   0.6843 |   0.8362 |
| Random forest              |  0.883 |    0.8067 |    0.825 |   0.9018 |
| XGBoost                    |  0.851 |    0.8242 |   0.8248 |   0.9119 |
| **CatBoost**                   | **0.9004** |     **0.863** |    **0.868** |   **0.9139** |
